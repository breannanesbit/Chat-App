@page "/chatRoom"
<PageTitle>Chat Room</PageTitle>
<div class="vh-100 pb-5 d-flex flex-column overflow-hidden container-fluid">
    <div class="  m-0 p-2 text-center row flex-grow-0 ">
        <h3 class="m-0">Chat Room</h3>
    </div>
    <div class="h-100 border  m-0 p-2 rounded-3 text-center row flex-grow-1 overflow-auto ">
        @if (messages != null)
        {
            <div class="h-100 flex-column d-flex justify-content-start ">
            @foreach (var message in messages)
            {
                <div class=" border border-dark rounded-3 p-2 mb-2 row bg-light ">
                    <h5 class="d-flex justify-content-start">@message.User   </h5>
                    <p class="m-0 text-start">@message.Message</p>
                    <p class="d-flex justify-content-end m-0"> @message.Time</p>
                </div>
            }
            </div>
        }
    </div>
    <div class="border rounded-3 m-0 p-2 text-center row flex-grow-0 mb-5">
        <form class="p-0 m-0  row" @formname="message-form" onsubmit="return false">
            <div class="col-10">
                    <div class="form-group row">
                        <label class="col-3 text-end">
                            Name:
                        </label>
                        <div class="col-9">
                            <input class=" form-control m-0 p-1" @bind="newMessage!.User"  placeholder="Tom Riddle"/>
                        </div>
                    </div>
                    <div class="form-group row mt-1">
                        <label class="col-3 text-end">
                            Message:
                        </label>
                        <div class="col-9 align-content-end">
                            <input class="form-control m-0 p-1" @bind="newMessage!.Message" placeholder="Hello!" />
                        </div>
                    </div>
            </div>
            <div class="col col-2">
                <div class="form-group mt-3 row align-content-end">
                    <button class="btn btn-primary" type="submit" @onclick="SendMessage" > Send</button>
                </div>
            </div>
        </form>
    </div>
</div>

@code {
    public ChatBox? newMessage { get; set; } = new ChatBox();

    public class ChatBox {
        public String Time { get; set; }
        public String User { get; set; }
        public String Message { get; set; }
    }

    ChatBox[] messages = new ChatBox[]
    {
        new ChatBox{Time = "1/11/2024 1:33:55 PM", User= "Tom",Message = "I have returned!" },
        new ChatBox{Time = "1/11/2024 1:34:55 PM", User= "Riddle", Message="About Time!"},
    };

    void SendMessage()
    {
        newMessage.Time = DateTime.Now.ToString();
        messages = messages.Concat(new[] { newMessage }).ToArray();
        newMessage = new ChatBox();
    }
}
